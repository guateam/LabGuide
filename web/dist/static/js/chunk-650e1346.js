(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-650e1346"],{"02f4":function(e,t,r){var a=r("4588"),n=r("be13");e.exports=function(e){return function(t,r){var i,o,s=String(n(t)),c=a(r),l=s.length;return c<0||c>=l?e?"":void 0:(i=s.charCodeAt(c),i<55296||i>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?e?s.charAt(c):i:e?s.slice(c,c+2):o-56320+(i-55296<<10)+65536)}}},"0390":function(e,t,r){"use strict";var a=r("02f4")(!0);e.exports=function(e,t,r){return t+(r?a(e,t).length:1)}},"0bfb":function(e,t,r){"use strict";var a=r("cb7c");e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"214f":function(e,t,r){"use strict";r("b0c5");var a=r("2aba"),n=r("32e9"),i=r("79e5"),o=r("be13"),s=r("2b4c"),c=r("520a"),l=s("species"),u=!i(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();e.exports=function(e,t,r){var f=s(e),m=!i(function(){var t={};return t[f]=function(){return 7},7!=""[e](t)}),p=m?!i(function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[l]=function(){return r}),r[f](""),!t}):void 0;if(!m||!p||"replace"===e&&!u||"split"===e&&!d){var g=/./[f],v=r(o,f,""[e],function(e,t,r,a,n){return t.exec===c?m&&!n?{done:!0,value:g.call(t,r,a)}:{done:!0,value:e.call(r,t,a)}:{done:!1}}),h=v[0],b=v[1];a(String.prototype,e,h),n(RegExp.prototype,f,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},"520a":function(e,t,r){"use strict";var a=r("0bfb"),n=RegExp.prototype.exec,i=String.prototype.replace,o=n,s="lastIndex",c=function(){var e=/a/,t=/b*/g;return n.call(e,"a"),n.call(t,"a"),0!==e[s]||0!==t[s]}(),l=void 0!==/()??/.exec("")[1],u=c||l;u&&(o=function(e){var t,r,o,u,d=this;return l&&(r=new RegExp("^"+d.source+"$(?!\\s)",a.call(d))),c&&(t=d[s]),o=n.call(d,e),c&&o&&(d[s]=d.global?o.index+o[0].length:t),l&&o&&o.length>1&&i.call(o[0],r,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(o[u]=void 0)}),o}),e.exports=o},"5f1b":function(e,t,r){"use strict";var a=r("23c6"),n=RegExp.prototype.exec;e.exports=function(e,t){var r=e.exec;if("function"===typeof r){var i=r.call(e,t);if("object"!==typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==a(e))throw new TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},a481:function(e,t,r){"use strict";var a=r("cb7c"),n=r("4bf8"),i=r("9def"),o=r("4588"),s=r("0390"),c=r("5f1b"),l=Math.max,u=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,m=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};r("214f")("replace",2,function(e,t,r,g){return[function(a,n){var i=e(this),o=void 0==a?void 0:a[t];return void 0!==o?o.call(a,i,n):r.call(String(i),a,n)},function(e,t){var n=g(r,e,this,t);if(n.done)return n.value;var d=a(e),f=String(this),m="function"===typeof t;m||(t=String(t));var h=d.global;if(h){var b=d.unicode;d.lastIndex=0}var x=[];while(1){var _=c(d,f);if(null===_)break;if(x.push(_),!h)break;var w=String(_[0]);""===w&&(d.lastIndex=s(f,i(d.lastIndex),b))}for(var y="",k=0,S=0;S<x.length;S++){_=x[S];for(var $=String(_[0]),E=l(u(o(_.index),f.length),0),M=[],R=1;R<_.length;R++)M.push(p(_[R]));var U=_.groups;if(m){var z=[$].concat(M,E,f);void 0!==U&&z.push(U);var A=String(t.apply(void 0,z))}else A=v($,f,E,M,U,t);E>=k&&(y+=f.slice(k,E)+A,k=E+$.length)}return y+f.slice(k)}];function v(e,t,a,i,o,s){var c=a+e.length,l=i.length,u=m;return void 0!==o&&(o=n(o),u=f),r.call(s,u,function(r,n){var s;switch(n.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(c);case"<":s=o[n.slice(1,-1)];break;default:var u=+n;if(0===u)return r;if(u>l){var f=d(u/10);return 0===f?r:f<=l?void 0===i[f-1]?n.charAt(1):i[f-1]+n.charAt(1):r}s=i[u-1]}return void 0===s?"":s})}})},b0c5:function(e,t,r){"use strict";var a=r("520a");r("5ca1")({target:"RegExp",proto:!0,forced:a!==/./.exec},{exec:a})},edf8:function(e,t,r){},fc56:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg"},[r("card",{class:{login:!0,top:!e.newcome},staticStyle:{"margin-bottom":"10%"},attrs:{id:"register",bordered:!1}},[r("p",{attrs:{slot:"title"},slot:"title"},[e._v("注册到实验室")]),r("i-form",{ref:"check_form",attrs:{model:e.info,rules:e.snum_rule,hidden:!e.newcome},nativeOn:{submit:function(e){e.preventDefault()}}},[r("form-item",{attrs:{label:"学号",prop:"snum"}},[r("i-input",{attrs:{size:"large",placeholder:"输入学号"},model:{value:e.info.snum,callback:function(t){e.$set(e.info,"snum",t)},expression:"info.snum"}})],1),r("form-item",{staticStyle:{"text-align":"center"}},[r("i-button",{staticStyle:{width:"40%","margin-top":"1%"},attrs:{size:"large",type:"success"},on:{click:e.check_snum}},[e._v("\n                    检测学号\n                ")]),r("i-button",{staticStyle:{"margin-left":"1%",width:"40%","margin-top":"1%"},attrs:{size:"large"},on:{click:function(t){return e.$router.back()}}},[e._v("\n                    取消\n                ")])],1)],1),r("i-form",{ref:"register_form",attrs:{model:e.info,rules:e.rule,hidden:e.newcome},nativeOn:{submit:function(e){e.preventDefault()}}},[r("form-item",{attrs:{label:"用户名",prop:"username"}},[r("i-input",{attrs:{size:"large",placeholder:"输入用户名"},model:{value:e.info.username,callback:function(t){e.$set(e.info,"username",t)},expression:"info.username"}})],1),r("form-item",{attrs:{label:"密码",prop:"password"}},[r("i-input",{attrs:{size:"large",type:"password",placeholder:"输入密码"},model:{value:e.info.password,callback:function(t){e.$set(e.info,"password",t)},expression:"info.password"}})],1),r("form-item",{attrs:{label:"重复密码",prop:"repassword"}},[r("i-input",{attrs:{size:"large",type:"password",placeholder:"重复密码"},model:{value:e.info.repassword,callback:function(t){e.$set(e.info,"repassword",t)},expression:"info.repassword"}})],1),r("form-item",{attrs:{label:"人脸录入",prop:"face"}},[r("video",{attrs:{width:"100%",autoplay:"autoplay"}}),r("canvas",{attrs:{id:"canvas1",hidden:!0}}),e.exArray.length<=1?r("div",[r("i-button",{attrs:{type:"primary",long:"",disabled:e.camera_close},domProps:{textContent:e._s(e.button_text)},on:{click:e.draw_photo}})],1):e._e(),e.exArray.length>1?r("div",{staticStyle:{"text-align":"center"}},[r("i-button",{staticStyle:{width:"45%","margin-top":"1%"},attrs:{type:"primary",disabled:e.camera_close},domProps:{textContent:e._s(e.button_text)},on:{click:e.draw_photo}}),r("i-button",{staticStyle:{width:"45%","margin-top":"1%","margin-left":"1%"},attrs:{type:"success",disabled:e.camera_close},domProps:{textContent:e._s(e.button_text)},on:{click:e.change_camera}})],1):e._e()]),r("form-item",{staticStyle:{"text-align":"center"}},[r("i-button",{staticStyle:{"margin-left":"10px",width:"40%","margin-top":"1%"},attrs:{size:"large",type:"success",long:""},on:{click:e.register}},[e._v("\n                    注册\n                ")]),r("i-button",{staticStyle:{"margin-left":"1%",width:"40%","margin-top":"1%"},attrs:{size:"large",type:"",long:""},on:{click:function(t){return e.$router.back()}}},[e._v("\n                    取消\n                ")])],1)],1)],1),r("modal",{attrs:{title:"提示"},model:{value:e.closable_modal,callback:function(t){e.closable_modal=t},expression:"closable_modal"}},[r("p",{domProps:{textContent:e._s(e.alert_info)}})])],1)},n=[],i=(r("a481"),{name:"register",components:{},data:function(){var e=this,t=function(t,r,a){""!=e.info.password&&""==r?a(new Error("确认密码不能为空")):e.info.password!=r?a(new Error("新密码和确认密码应相同")):a()};return{info:{username:"",password:"",repassword:"",face:null,snum:""},rule:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{type:"string",min:6,message:"密码长度必须大于6位",trigger:"blur"}],repassword:[{required:!0,message:"重复密码不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],face:[{required:!0,message:"请录入人脸"}]},snum_rule:{snum:[{required:!0,message:"学号不能为空",trigger:"blur"}]},video:null,exArray:[],canvas:null,context:null,camera_close:!0,button_text:"收集人脸",newcome:!0,closable_modal:!1,alert_info:"",exnum:0}},methods:{change_camera:function(){this.exnum<this.exArray.length?(this.exnum++,this.getMedia()):(this.exnum=0,this.getMedia())},getMedia:function(){var e=this;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.mediaDevices.enumerateDevices().then(function(t){for(var r=0;r!=t.length;++r){var a=t[r];"video"===a.kind&&e.exArray.push(a.id)}}),navigator.getUserMedia?navigator.getUserMedia({video:{optional:[{sourceId:e.exArray[this.exnum]}]},audio:!1},e.successFunc,e.errorFunc):alert("Native device media streaming (getUserMedia) not supported in this browser.")},successFunc:function(e){void 0!==this.video.mozSrcObject?this.video.mozSrcObject=e:this.video.srcObject=e,this.video.play(),this.camera_close=!1},errorFunc:function(e){this.closable_modal=!0,this.alert_info="错误:"+e},draw_photo:function(){var e=this;document.getElementById("canvas1").height=this.video.offsetHeight,document.getElementById("canvas1").width=this.video.offsetWidth,e.context.drawImage(e.video,0,0,this.video.offsetWidth,this.video.offsetHeight);var t=e.canvas.toDataURL("image/png",1);t=t.replace(/data:image\/(jpeg|png|gif|bmp);base64,/i,""),e.button_text="正在检测人脸",e.camera_close=!0,this.$api.face.exist({face:t,h:this.video.offsetHeight,w:this.video.offsetWidth}).then(function(r){1===r.data.code?(e.info.face=t,e.button_text="收集完成",e.camera_close=!1):(0===r.data.code?(e.closable_modal=!0,e.alert_info="人脸位置太偏，请将人脸尽量处于正中间"):-1===r.data.code?(e.closable_modal=!0,e.alert_info="人脸数量过多，最多只能出现一个人脸"):-2===r.data.code?18==r.data.data?(e.closable_modal=!0,e.alert_info="人脸识别服务器繁忙，请重试"):222202==r.data.data&&(e.closable_modal=!0,e.alert_info="未检测到人脸，请重新收集"):-3===r.data.code?(e.closable_modal=!0,e.alert_info="未知错误，采集失败"):-4===r.data.code&&(e.closable_modal=!0,e.alert_info="人脸距离摄像头过近，导致人脸太大，请适当远离摄像头"),e.camera_close=!1,e.button_text="收集人脸")})},register:function(){var e=this,t=this;this.$refs["register_form"].validate(function(r){if(r){var a={username:t.info.username,password:t.info.password,snum:t.info.snum,face:t.info.face};e.$api.account.register(a).then(function(e){1===e.data.code?t.$router.push({name:"login"}):(t.closable_modal=!0,t.alert_info="注册失败,请重试")})}})},check_snum:function(){var e=this,t=this;this.$refs["check_form"].validate(function(r){r&&e.$api.account.check_snum(t.info).then(function(e){1===e.data.code?t.newcome=!1:0===e.data.code?(t.closable_modal=!0,t.alert_info="该学号未加入本实验室，无法注册"):-1===e.data.code&&(t.closable_modal=!0,t.alert_info="该学号已经被注册")})})}},mounted:function(){this.video=document.querySelector("video"),this.canvas=document.getElementById("canvas1"),this.context=this.canvas.getContext("2d"),this.getMedia()}}),o=i,s=(r("ffb8"),r("2877")),c=Object(s["a"])(o,a,n,!1,null,"017326a6",null);t["default"]=c.exports},ffb8:function(e,t,r){"use strict";var a=r("edf8"),n=r.n(a);n.a}}]);
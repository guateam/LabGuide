(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d483fe08"],{"02f4":function(e,t,r){var n=r("4588"),a=r("be13");e.exports=function(e){return function(t,r){var i,o,s=String(a(t)),c=n(r),l=s.length;return c<0||c>=l?e?"":void 0:(i=s.charCodeAt(c),i<55296||i>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?e?s.charAt(c):i:e?s.slice(c,c+2):o-56320+(i-55296<<10)+65536)}}},"0390":function(e,t,r){"use strict";var n=r("02f4")(!0);e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},"0604":function(e,t,r){e.exports=r.p+"static/img/bg.jpg"},"0bfb":function(e,t,r){"use strict";var n=r("cb7c");e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"214f":function(e,t,r){"use strict";r("b0c5");var n=r("2aba"),a=r("32e9"),i=r("79e5"),o=r("be13"),s=r("2b4c"),c=r("520a"),l=s("species"),u=!i(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();e.exports=function(e,t,r){var f=s(e),p=!i(function(){var t={};return t[f]=function(){return 7},7!=""[e](t)}),g=p?!i(function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[l]=function(){return r}),r[f](""),!t}):void 0;if(!p||!g||"replace"===e&&!u||"split"===e&&!d){var v=/./[f],m=r(o,f,""[e],function(e,t,r,n,a){return t.exec===c?p&&!a?{done:!0,value:v.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),h=m[0],b=m[1];n(String.prototype,e,h),a(RegExp.prototype,f,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},"46d6":function(e,t,r){},"520a":function(e,t,r){"use strict";var n=r("0bfb"),a=RegExp.prototype.exec,i=String.prototype.replace,o=a,s="lastIndex",c=function(){var e=/a/,t=/b*/g;return a.call(e,"a"),a.call(t,"a"),0!==e[s]||0!==t[s]}(),l=void 0!==/()??/.exec("")[1],u=c||l;u&&(o=function(e){var t,r,o,u,d=this;return l&&(r=new RegExp("^"+d.source+"$(?!\\s)",n.call(d))),c&&(t=d[s]),o=a.call(d,e),c&&o&&(d[s]=d.global?o.index+o[0].length:t),l&&o&&o.length>1&&i.call(o[0],r,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(o[u]=void 0)}),o}),e.exports=o},"5f1b":function(e,t,r){"use strict";var n=r("23c6"),a=RegExp.prototype.exec;e.exports=function(e,t){var r=e.exec;if("function"===typeof r){var i=r.call(e,t);if("object"!==typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==n(e))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(e,t)}},a481:function(e,t,r){"use strict";var n=r("cb7c"),a=r("4bf8"),i=r("9def"),o=r("4588"),s=r("0390"),c=r("5f1b"),l=Math.max,u=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,g=function(e){return void 0===e?e:String(e)};r("214f")("replace",2,function(e,t,r,v){return[function(n,a){var i=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,i,a):r.call(String(i),n,a)},function(e,t){var a=v(r,e,this,t);if(a.done)return a.value;var d=n(e),f=String(this),p="function"===typeof t;p||(t=String(t));var h=d.global;if(h){var b=d.unicode;d.lastIndex=0}var x=[];while(1){var w=c(d,f);if(null===w)break;if(x.push(w),!h)break;var _=String(w[0]);""===_&&(d.lastIndex=s(f,i(d.lastIndex),b))}for(var y="",k=0,$=0;$<x.length;$++){w=x[$];for(var S=String(w[0]),R=l(u(o(w.index),f.length),0),E=[],U=1;U<w.length;U++)E.push(g(w[U]));var z=w.groups;if(p){var M=[S].concat(E,R,f);void 0!==z&&M.push(z);var A=String(t.apply(void 0,M))}else A=m(S,f,R,E,z,t);R>=k&&(y+=f.slice(k,R)+A,k=R+S.length)}return y+f.slice(k)}];function m(e,t,n,i,o,s){var c=n+e.length,l=i.length,u=p;return void 0!==o&&(o=a(o),u=f),r.call(s,u,function(r,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(c);case"<":s=o[a.slice(1,-1)];break;default:var u=+a;if(0===u)return r;if(u>l){var f=d(u/10);return 0===f?r:f<=l?void 0===i[f-1]?a.charAt(1):i[f-1]+a.charAt(1):r}s=i[u-1]}return void 0===s?"":s})}})},b0c5:function(e,t,r){"use strict";var n=r("520a");r("5ca1")({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},b2de:function(e,t,r){"use strict";var n=r("46d6"),a=r.n(n);a.a},fc56:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{style:e.bg,attrs:{id:"register"}},[r("card",{staticClass:"login",attrs:{id:"register",bordered:!1}},[r("p",{attrs:{slot:"title"},slot:"title"},[e._v("注册到实验室")]),r("i-form",{ref:"check_form",attrs:{model:e.info,rules:e.snum_rule,hidden:!e.newcome}},[r("form-item",{attrs:{label:"学号",prop:"snum"}},[r("i-input",{attrs:{size:"large",placeholder:"输入学号"},model:{value:e.info.snum,callback:function(t){e.$set(e.info,"snum",t)},expression:"info.snum"}})],1),r("form-item",[r("i-button",{staticStyle:{width:"120px"},attrs:{size:"large",type:"success"},on:{click:e.check_snum}},[e._v("\n                    检测学号\n                ")]),r("i-button",{staticStyle:{"margin-left":"8px",width:"120px"},attrs:{size:"large"},on:{click:function(t){return e.$router.back()}}},[e._v("\n                    取消\n                ")])],1)],1),r("i-form",{ref:"register_form",attrs:{model:e.info,rules:e.rule,hidden:e.newcome}},[r("form-item",{attrs:{label:"用户名",prop:"username"}},[r("i-input",{attrs:{size:"large",placeholder:"输入用户名"},model:{value:e.info.username,callback:function(t){e.$set(e.info,"username",t)},expression:"info.username"}})],1),r("form-item",{attrs:{label:"密码",prop:"password"}},[r("i-input",{attrs:{size:"large",type:"password",placeholder:"输入密码"},model:{value:e.info.password,callback:function(t){e.$set(e.info,"password",t)},expression:"info.password"}})],1),r("form-item",{attrs:{label:"重复密码",prop:"repassword"}},[r("i-input",{attrs:{size:"large",type:"password",placeholder:"重复密码"},model:{value:e.info.repassword,callback:function(t){e.$set(e.info,"repassword",t)},expression:"info.repassword"}})],1),r("form-item",{attrs:{label:"人脸录入",prop:"face"}},[r("video",{staticStyle:{"margin-left":"20%"},attrs:{width:"50%",autoplay:"autoplay"}}),r("canvas",{attrs:{id:"canvas1",hidden:!0,width:"1000px",height:"800px"}}),r("i-button",{attrs:{type:"primary",long:"",disabled:e.camera_close},domProps:{textContent:e._s(e.button_text)},on:{click:e.draw_photo}})],1),r("form-item",[r("i-button",{staticStyle:{"margin-left":"10px",width:"120px"},attrs:{size:"large",type:"success",long:""},on:{click:e.register}},[e._v("\n                    注册\n                ")]),r("i-button",{staticStyle:{"margin-left":"10px",width:"120px"},attrs:{size:"large",type:"",long:""},on:{click:function(t){return e.$router.back()}}},[e._v("\n                    取消\n                ")])],1)],1)],1),r("modal",{attrs:{title:"提示"},model:{value:e.closable_modal,callback:function(t){e.closable_modal=t},expression:"closable_modal"}},[r("p",{domProps:{textContent:e._s(e.alert_info)}})])],1)},a=[],i=(r("a481"),{name:"register",components:{},data:function(){var e=this,t=function(t,r,n){""!=e.info.password&&""==r?n(new Error("确认密码不能为空")):e.info.password!=r?n(new Error("新密码和确认密码应相同")):n()};return{bg:{backgroundImage:"url("+r("0604")+")",backgroundRepeat:"no-repeat",width:"100%",height:"100%",position:"absolute",backgroundSize:"100% 100%",verticalAlign:"middle"},info:{username:"",password:"",repassword:"",face:null,snum:""},rule:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{type:"string",min:6,message:"密码长度必须大于6位",trigger:"blur"}],repassword:[{required:!0,message:"重复密码不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],face:[{required:!0,message:"请录入人脸"}]},snum_rule:{snum:[{required:!0,message:"学号不能为空",trigger:"blur"}]},video:null,exArray:[],canvas:null,context:null,camera_close:!0,button_text:"收集人脸",newcome:!0,closable_modal:!1,alert_info:""}},methods:{getMedia:function(){var e=this;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.mediaDevices.enumerateDevices().then(function(t){for(var r=0;r!=t.length;++r){var n=t[r];"video"===n.kind&&e.exArray.push(n.id)}}),navigator.getUserMedia?navigator.getUserMedia({video:{optional:[{sourceId:e.exArray[0]}]},audio:!1},e.successFunc,e.errorFunc):alert("Native device media streaming (getUserMedia) not supported in this browser.")},successFunc:function(e){void 0!==this.video.mozSrcObject?this.video.mozSrcObject=e:this.video.srcObject=e,this.video.play(),this.camera_close=!1},errorFunc:function(e){this.closable_modal=!0,this.alert_info="错误:"+e},draw_photo:function(){var e=this;e.context.drawImage(e.video,0,0,1e3,800);var t=e.canvas.toDataURL("image/png",1);t=t.replace(/data:image\/(jpeg|png|gif|bmp);base64,/i,""),e.button_text="正在检测人脸",this.$api.face.exist({face:t}).then(function(r){1===r.data.code?(e.info.face=t,e.button_text="收集完成"):e.button_text="未检测到人脸，请重新收集"})},register:function(){var e=this,t=this;this.$refs["register_form"].validate(function(r){if(r){var n={username:t.info.username,password:t.info.password,snum:t.info.snum,face:t.info.face};e.$api.account.register(n).then(function(e){1===e.data.code?t.$router.push({name:"login"}):(t.closable_modal=!0,t.alert_info="注册失败,请重试")})}})},check_snum:function(){var e=this,t=this;this.$refs["check_form"].validate(function(r){r&&e.$api.account.check_snum(t.info).then(function(e){1===e.data.code?t.newcome=!1:0===e.data.code?(t.closable_modal=!0,t.alert_info="该学号未加入本实验室，无法注册"):-1===e.data.code&&(t.closable_modal=!0,t.alert_info="该学号已经被注册")})})}},mounted:function(){this.video=document.querySelector("video"),this.canvas=document.getElementById("canvas1"),this.context=this.canvas.getContext("2d"),this.getMedia()}}),o=i,s=(r("b2de"),r("2877")),c=Object(s["a"])(o,n,a,!1,null,"56389df6",null);t["default"]=c.exports}}]);
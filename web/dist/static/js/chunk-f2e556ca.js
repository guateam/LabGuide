(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f2e556ca"],{"0474":function(t,e,i){},"116d":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Card",{staticStyle:{"margin-top":"2%"}},[i("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n        添加文章\n    ")]),i("div",{attrs:{slot:"extra"},slot:"extra"},[i("span",{staticStyle:{"margin-right":"10px"}},[t._v("自动保存")]),i("i-switch",{attrs:{size:"large"},model:{value:t.auto_save,callback:function(e){t.auto_save=e},expression:"auto_save"}},[i("span",{attrs:{slot:"open"},slot:"open"},[t._v("开")]),i("span",{attrs:{slot:"close"},slot:"close"},[t._v("关")])])],1),i("Form",{attrs:{"label-position":"top"}},[i("FormItem",{attrs:{label:"标题"}},[i("Input",{on:{blur:t.save_article},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),i("FormItem",{attrs:{label:"正文"}},[i("div",{staticStyle:{height:"70vh"}},[i("quill-editor",{staticStyle:{height:"90%"},attrs:{options:t.options},on:{blur:function(e){return t.save_article()}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)]),i("FormItem",[i("Button",{attrs:{type:"primary"},on:{click:t.add_article}},[t._v("提交")]),i("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"success"},on:{click:t.save_article_cache}},[t._v("保存")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.cancel_edit()}}},[t._v("取消")])],1)],1)],1)},a=[],o=i("1487"),c=i.n(o),r=(i("6e2e"),i("9339")),l=i("f318"),s=i.n(l),u=i("5dde"),d=i("3b2f");window.katex=d;var h=i("06ea");r["register"](h.TableCell),r["register"](h.TableRow),r["register"](h.Table),r["register"](h.Contain),r["register"]("modules/table",h.TableModule),r["register"]("modules/imageResize",s.a),r["register"]("modules/ImageExtend",u["a"]);for(var b=10,p=5,_=[],f=1;f<=b;f++)for(var g=1;g<=p;g++)_.push("newtable_"+f+"_"+g);var m={name:"add_article",data:function(){return{content:"",title:"",query:"",auto_save:!0,request:void 0,db:void 0,options:{modules:{formula:!0,syntax:{highlight:function(t){return c.a.highlightAuto(t).value}},table:!0,markdownShortcuts:{},ImageExtend:{loading:!0,name:"picture",size:3,action:"https://www.wiseweblab.com/api/api/upload/upload_picture",response:function(t){return t.data}},imageResize:{modules:["Resize","DisplaySize","Toolbar"]},toolbar:{container:[["bold","italic","underline","strike"],[{header:[1,2,3,4,!1]},{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"},{align:[]}],["blockquote","code-block","link","image","formula"],[{color:[]},{background:[]}],[{table:_},{table:"append-row"},{table:"append-col"}],["clean"]],handlers:{image:function(){u["b"].emit(this.quill.id)}}}},placeholder:"请在此输入内容"}}},methods:{add_article:function(){var t=this,e=this,i={title:e.title,content:e.content,tag:e.query.id,token:e.$Cookies.get("token")};this.$api.article.add_article(i).then(function(i){1===i.data.code&&(e.title="",e.content="",e.delete_article_cache(),t.$router.go(-1))})},cancel_edit:function(){this.delete_article_cache(),this.$router.back()},save_article:function(){this.auto_save&&(this.$Notice.info({title:"正在自动保存···"}),this.save_article_cache())},load_article_cache:function(){var t=this.db.transaction("article","readwrite").objectStore("article").get(1),e=this;t.onerror=function(t){e.$Notice.warning({title:"读取缓存失败"})},t.onsuccess=function(i){t.result?(e.content=t.result.content,e.title=t.result.title,e.$Notice.info({title:"已读取缓存"})):console.log("未获得数据记录")}},save_article_cache:function(){var t=this.db.transaction("article","readwrite").objectStore("article").add({id:1,content:this.content,title:this.title}),e=this;this.db.transaction("article","readwrite").objectStore("article").put({id:1,content:this.content,title:this.title});t.onsuccess=function(t){e.$Notice.warning({title:"本地保存失败,请重试(第一次保存可能出现失败情况)"})},t.onerror=function(t){e.$Notice.success({title:"本地保存成功"})}},delete_article_cache:function(){var t=this.db.transaction(["article"],"readwrite").objectStore("article").delete(1),e=this;t.onsuccess=function(t){e.$Notice.info({title:"本地缓存已释放"})},t.onerror=function(t){e.$Notice.warning({title:"本地缓存释放失败"})}}},mounted:function(){this.query=this.$route.query,this.request=window.indexedDB.open("article_cache"),this.request.onerror=function(t){this.$Notice.warning({title:"本地数据库打开失败",desc:"本地数据库打开失败，文章将不会自动缓存！"})};var t=this;this.request.onsuccess=function(e){t.db=e.target.result,t.load_article_cache()},this.request.onupgradeneeded=function(e){var i;t.db=e.target.result,t.db.objectStoreNames.contains("article")||(i=t.db.createObjectStore("article",{keyPath:"id",autoIncrement:!0}),i.createIndex("content","content",{unique:!0}),i.createIndex("title","title",{unique:!0})),t.db.objectStoreNames.contains("change_article")||(i=t.db.createObjectStore("change_article",{keyPath:"id",autoIncrement:!0}),i.createIndex("content","content",{unique:!0}),i.createIndex("title","title",{unique:!0}))}}},v=m,w=(i("ba88"),i("2877")),k=Object(w["a"])(v,n,a,!1,null,"6c6ec0c2",null);e["default"]=k.exports},ba88:function(t,e,i){"use strict";var n=i("0474"),a=i.n(n);a.a}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-becfdcd8"],{"02f4":function(e,t,a){var r=a("4588"),n=a("be13");e.exports=function(e){return function(t,a){var o,i,s=String(n(t)),c=r(a),l=s.length;return c<0||c>=l?e?"":void 0:(o=s.charCodeAt(c),o<55296||o>56319||c+1===l||(i=s.charCodeAt(c+1))<56320||i>57343?e?s.charAt(c):o:e?s.slice(c,c+2):i-56320+(o-55296<<10)+65536)}}},"0390":function(e,t,a){"use strict";var r=a("02f4")(!0);e.exports=function(e,t,a){return t+(a?r(e,t).length:1)}},"0bfb":function(e,t,a){"use strict";var r=a("cb7c");e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"214f":function(e,t,a){"use strict";a("b0c5");var r=a("2aba"),n=a("32e9"),o=a("79e5"),i=a("be13"),s=a("2b4c"),c=a("520a"),l=s("species"),u=!o(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2===a.length&&"a"===a[0]&&"b"===a[1]}();e.exports=function(e,t,a){var f=s(e),m=!o(function(){var t={};return t[f]=function(){return 7},7!=""[e](t)}),p=m?!o(function(){var t=!1,a=/a/;return a.exec=function(){return t=!0,null},"split"===e&&(a.constructor={},a.constructor[l]=function(){return a}),a[f](""),!t}):void 0;if(!m||!p||"replace"===e&&!u||"split"===e&&!d){var g=/./[f],h=a(i,f,""[e],function(e,t,a,r,n){return t.exec===c?m&&!n?{done:!0,value:g.call(t,a,r)}:{done:!0,value:e.call(a,t,r)}:{done:!1}}),v=h[0],b=h[1];r(String.prototype,e,v),n(RegExp.prototype,f,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},"520a":function(e,t,a){"use strict";var r=a("0bfb"),n=RegExp.prototype.exec,o=String.prototype.replace,i=n,s="lastIndex",c=function(){var e=/a/,t=/b*/g;return n.call(e,"a"),n.call(t,"a"),0!==e[s]||0!==t[s]}(),l=void 0!==/()??/.exec("")[1],u=c||l;u&&(i=function(e){var t,a,i,u,d=this;return l&&(a=new RegExp("^"+d.source+"$(?!\\s)",r.call(d))),c&&(t=d[s]),i=n.call(d,e),c&&i&&(d[s]=d.global?i.index+i[0].length:t),l&&i&&i.length>1&&o.call(i[0],a,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(i[u]=void 0)}),i}),e.exports=i},"5bb1":function(e,t,a){"use strict";var r=a("a2e2"),n=a.n(r);n.a},"5f1b":function(e,t,a){"use strict";var r=a("23c6"),n=RegExp.prototype.exec;e.exports=function(e,t){var a=e.exec;if("function"===typeof a){var o=a.call(e,t);if("object"!==typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},a2e2:function(e,t,a){},a481:function(e,t,a){"use strict";var r=a("cb7c"),n=a("4bf8"),o=a("9def"),i=a("4588"),s=a("0390"),c=a("5f1b"),l=Math.max,u=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,m=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};a("214f")("replace",2,function(e,t,a,g){return[function(r,n){var o=e(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,o,n):a.call(String(o),r,n)},function(e,t){var n=g(a,e,this,t);if(n.done)return n.value;var d=r(e),f=String(this),m="function"===typeof t;m||(t=String(t));var v=d.global;if(v){var b=d.unicode;d.lastIndex=0}var x=[];while(1){var _=c(d,f);if(null===_)break;if(x.push(_),!v)break;var w=String(_[0]);""===w&&(d.lastIndex=s(f,o(d.lastIndex),b))}for(var y="",k=0,S=0;S<x.length;S++){_=x[S];for(var $=String(_[0]),E=l(u(i(_.index),f.length),0),M=[],R=1;R<_.length;R++)M.push(p(_[R]));var U=_.groups;if(m){var C=[$].concat(M,E,f);void 0!==U&&C.push(U);var z=String(t.apply(void 0,C))}else z=h($,f,E,M,U,t);E>=k&&(y+=f.slice(k,E)+z,k=E+$.length)}return y+f.slice(k)}];function h(e,t,r,o,i,s){var c=r+e.length,l=o.length,u=m;return void 0!==i&&(i=n(i),u=f),a.call(s,u,function(a,n){var s;switch(n.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(c);case"<":s=i[n.slice(1,-1)];break;default:var u=+n;if(0===u)return a;if(u>l){var f=d(u/10);return 0===f?a:f<=l?void 0===o[f-1]?n.charAt(1):o[f-1]+n.charAt(1):a}s=o[u-1]}return void 0===s?"":s})}})},b0c5:function(e,t,a){"use strict";var r=a("520a");a("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},fc56:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bg"},[a("card",{staticClass:"card",class:{login:!0,top:!e.newcome},staticStyle:{"margin-bottom":"10%"},attrs:{id:"register",bordered:!1}},[a("p",{staticClass:"form_title",attrs:{slot:"title"},slot:"title"},[e._v("注册到实验室")]),a("i-form",{ref:"check_form",staticClass:"form",attrs:{model:e.info,rules:e.snum_rule,hidden:!e.newcome},nativeOn:{submit:function(e){e.preventDefault()}}},[a("form-item",{attrs:{label:"学号",prop:"snum"}},[a("i-input",{attrs:{size:"large",placeholder:"输入学号"},model:{value:e.info.snum,callback:function(t){e.$set(e.info,"snum",t)},expression:"info.snum"}})],1),a("form-item",{staticStyle:{"text-align":"center"}},[a("i-button",{staticStyle:{width:"45%","margin-top":"1%"},attrs:{size:"large",type:"success",ghost:""},on:{click:e.check_snum}},[e._v("检测学号")]),a("i-button",{staticStyle:{"margin-left":"8%",width:"45%","margin-top":"1%"},attrs:{size:"large",type:"primary",ghost:""},on:{click:function(t){return e.$router.back()}}},[e._v("取消")])],1)],1),a("i-form",{ref:"register_form",staticClass:"form",attrs:{hidden:e.newcome,model:e.info,rules:e.rule},nativeOn:{submit:function(e){e.preventDefault()}}},[a("form-item",{attrs:{label:"用户名",prop:"username"}},[a("i-input",{attrs:{size:"large",placeholder:"输入用户名"},model:{value:e.info.username,callback:function(t){e.$set(e.info,"username",t)},expression:"info.username"}})],1),a("form-item",{attrs:{label:"密码",prop:"password"}},[a("i-input",{attrs:{size:"large",type:"password",placeholder:"输入密码"},model:{value:e.info.password,callback:function(t){e.$set(e.info,"password",t)},expression:"info.password"}})],1),a("form-item",{attrs:{label:"重复密码",prop:"repassword"}},[a("i-input",{attrs:{size:"large",type:"password",placeholder:"重复密码"},model:{value:e.info.repassword,callback:function(t){e.$set(e.info,"repassword",t)},expression:"info.repassword"}})],1),a("form-item",{attrs:{label:"人脸录入",prop:"face"}},[a("video",{attrs:{width:"100%",autoplay:"autoplay"}}),a("canvas",{attrs:{id:"canvas1",hidden:!0}}),e.exArray.length<=1?a("div",[a("i-button",{attrs:{type:"primary",long:"",ghost:"",disabled:e.camera_close},domProps:{textContent:e._s(e.button_text)},on:{click:e.draw_photo}})],1):e._e(),e.exArray.length>1?a("div",{staticStyle:{"text-align":"center"}},[a("i-button",{staticStyle:{width:"45%","margin-top":"1%"},attrs:{type:"primary",ghost:"",disabled:e.camera_close},domProps:{textContent:e._s(e.button_text)},on:{click:e.draw_photo}}),a("i-button",{staticStyle:{width:"45%","margin-top":"1%","margin-left":"1%"},attrs:{type:"success",disabled:e.camera_close},domProps:{textContent:e._s(e.button_text)},on:{click:e.change_camera}})],1):e._e()]),a("form-item",{staticStyle:{"text-align":"center"}},[a("i-button",{staticStyle:{"margin-left":"10px",width:"45%","margin-top":"1%"},attrs:{size:"large",type:"success",ghost:"",long:""},on:{click:e.register}},[e._v("注册")]),a("i-button",{staticStyle:{"margin-left":"6%",width:"45%","margin-top":"1%"},attrs:{size:"large",type:"success",ghost:"",long:""},on:{click:function(t){return e.$router.back()}}},[e._v("取消")])],1)],1)],1),a("modal",{attrs:{title:"提示"},model:{value:e.closable_modal,callback:function(t){e.closable_modal=t},expression:"closable_modal"}},[a("p",{domProps:{textContent:e._s(e.alert_info)}})])],1)},n=[],o=(a("a481"),{name:"register",components:{},data:function(){var e=this,t=function(t,a,r){""!=e.info.password&&""==a?r(new Error("确认密码不能为空")):e.info.password!=a?r(new Error("新密码和确认密码应相同")):r()};return{info:{username:"",password:"",repassword:"",face:null,snum:""},rule:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{type:"string",min:6,message:"密码长度必须大于6位",trigger:"blur"}],repassword:[{required:!0,message:"重复密码不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],face:[{required:!0,message:"请录入人脸"}]},snum_rule:{snum:[{required:!0,message:"学号不能为空",trigger:"blur"}]},video:null,exArray:[],canvas:null,context:null,camera_close:!0,button_text:"收集人脸",newcome:!0,closable_modal:!1,alert_info:"",exnum:0}},methods:{change_camera:function(){this.exnum<this.exArray.length?(this.exnum++,this.getMedia()):(this.exnum=0,this.getMedia())},getMedia:function(){var e=this;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.mediaDevices.enumerateDevices().then(function(t){for(var a=0;a!=t.length;++a){var r=t[a];"video"===r.kind&&e.exArray.push(r.id)}}),navigator.getUserMedia?navigator.getUserMedia({video:{optional:[{sourceId:e.exArray[this.exnum]}]},audio:!1},e.successFunc,e.errorFunc):alert("Native device media streaming (getUserMedia) not supported in this browser.")},successFunc:function(e){void 0!==this.video.mozSrcObject?this.video.mozSrcObject=e:this.video.srcObject=e,this.video.play(),this.camera_close=!1},errorFunc:function(e){this.closable_modal=!0,this.alert_info="错误:"+e},draw_photo:function(){var e=this;document.getElementById("canvas1").height=this.video.offsetHeight,document.getElementById("canvas1").width=this.video.offsetWidth,e.context.drawImage(e.video,0,0,this.video.offsetWidth,this.video.offsetHeight);var t=e.canvas.toDataURL("image/png",1);t=t.replace(/data:image\/(jpeg|png|gif|bmp);base64,/i,""),e.button_text="正在检测人脸",e.camera_close=!0,this.$api.face.exist({face:t,h:this.video.offsetHeight,w:this.video.offsetWidth}).then(function(a){1===a.data.code?(e.info.face=t,e.button_text="收集完成",e.camera_close=!1):(0===a.data.code?(e.closable_modal=!0,e.alert_info="人脸位置太偏，请将人脸尽量处于正中间"):-1===a.data.code?(e.closable_modal=!0,e.alert_info="人脸数量过多，最多只能出现一个人脸"):-2===a.data.code?18==a.data.data?(e.closable_modal=!0,e.alert_info="人脸识别服务器繁忙，请重试"):222202==a.data.data&&(e.closable_modal=!0,e.alert_info="未检测到人脸，请重新收集"):-3===a.data.code?(e.closable_modal=!0,e.alert_info="未知错误，采集失败"):-4===a.data.code&&(e.closable_modal=!0,e.alert_info="人脸距离摄像头过近，导致人脸太大，请适当远离摄像头"),e.camera_close=!1,e.button_text="收集人脸")})},register:function(){var e=this,t=this;this.$refs["register_form"].validate(function(a){if(a){var r={username:t.info.username,password:t.info.password,snum:t.info.snum,face:t.info.face};e.$api.account.register(r).then(function(e){1===e.data.code?t.$router.push({name:"login"}):-2===e.data.code?(t.closable_modal=!0,t.alert_info="用户名重复，请重试"):(t.closable_modal=!0,t.alert_info="注册失败,请重试")})}})},check_snum:function(){var e=this,t=this;this.$refs["check_form"].validate(function(a){a&&e.$api.account.check_snum(t.info).then(function(e){1===e.data.code?t.newcome=!1:0===e.data.code?(t.closable_modal=!0,t.alert_info="该学号未加入本实验室，无法注册"):-1===e.data.code&&(t.closable_modal=!0,t.alert_info="该学号已经被注册")})})}},mounted:function(){this.video=document.querySelector("video"),this.canvas=document.getElementById("canvas1"),this.context=this.canvas.getContext("2d"),this.getMedia()}}),i=o,s=(a("5bb1"),a("2877")),c=Object(s["a"])(i,r,n,!1,null,"1d29a346",null);t["default"]=c.exports}}]);